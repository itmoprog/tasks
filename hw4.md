Занятие 4
=========

## Материал

### Изученные команды:

* [`awk`](http://linux.die.net/man/1/awk)
* [`whoami`](http://linux.die.net/man/1/whoami)
* [`finger`](http://linux.die.net/man/1/finger)
* [`users`](http://linux.die.net/man/1/users)
* [`last`](http://linux.die.net/man/1/last)

### Материал:

* Текстовый редактор `vi`
* Символы экранирования (escape characters): `''`, `""`, `\`
* Цикл `for`:

  ```shell
  for i in array
  do
    команды
  done
  ```
  или
  ```shell
  for i in array; do команды; done
  ```

## Домашнее задание №4

__К 7 ноября!__

### Ответы и решения

У себя в домашнем каталоге создайте директорию `hw4`, в ней — директории `tasks` и `enroll`. В обеих директориях, как и раньше, должны быть файлы с номерами заданий, в которых будут ответы на них. А сами решения (т.е. команды) так же присылайте мне на email.

### Практические задания (директория `tasks`)

1. Сколько всего пользователей залогинивалось на сервере?

  > _Подсказка_: пользователей от служебных команд можно отличить по тому, что первые «прикрепляются» к одному из псевдо-терминалов (т.е. `pts`).
  > 
  > _Важное дополнение_: сейчас сменился месяц, поэтому выдача команды `last` обнулилась. Используйте `last -f /var/log/wtmp.1` вместо просто `last`, чтобы получить данные по предыдущему месяцу.
* Выведите IP-адреса/host'ы, с которых активные пользователи системы выходили последний раз.

  > _Подсказка_: воспользуйтесь списком пользователей, который вы получите выше, и получите информацию о пользователях по их логинам.

### Работа с файлом `/home/enf/enroll` (директория `enroll`)

В файле содержится информация о поступивших на бюджет в ИТМО в этом году.

1. У скольки людей не указано отчество?
* Каково разнообразие (т.е. количество уникальных) женских имён?

  > _Подсказка_: у тех людей, у которых есть отчество, вы можете легко автоматически определить пол.
* Сколько всего представлено в ИТМО специальностей?

  > Дубли выводить не надо. Если одна специальность есть на двух и более кафедрах, это считается одной специальностью.
* Какие зафиксированы самый высокий и самый низкий баллы при поступлении? Указать каждый балл на разных строчках.

  > _Подсказка_: `man tail`.

### Необязательное задание

1. Каково предназначение следующего скрипта? Описать словами. Все непонятные моменты изучите самостоятельно, google вам в помощь :)

  ```shell
  for i in /home/*/hw2/info
  do
    givenstamp=`date --date="$(awk '{print $4}' $i | \
      awk -F- '{print $3"-"$2"-"$1}')" +%s`
    stamptocompare=`date --date="18 years ago" +%s`
    if [ $stamptocompare -lt $givenstamp ]
    then
      stampdiff=$((givenstamp-stamptocompare))
      echo "$stampdiff `awk '{print $1,$2}' $i` \
      `echo "scale=0;$stampdiff/86400+1" | bc`"
    fi
  done | sort -n | awk '{print $3,$2,"("$4")"}'
  ```
